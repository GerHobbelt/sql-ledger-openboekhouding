<?xml version="1.0" encoding="utf-8"?>
<sql-ledger-root>
  <letterhead>
    <title>CREDIT INVOICE</title>

    <%include letterhead.xml%>
    
  </letterhead>

<!-- 
 all XML formats have the same structure: the info is contained in a CONTENT block of certain TYPE.
 That way we can batch/merge XML files without loosing any data; all they'll share is 
 the LETTERHEAD block above and FOOTER block further below.
-->
  <content type="CREDIT-INVOICE" >
    <crm>
      <%name%>
      <%address1%>
      <%address2%>
      <%city%> 
      <%state%> 
      <%zipcode%> 
      <%country%> 
      <%contact%>
      <%customerphone%> 
      <%customerfax%> 
      <%email%>
      <%customertaxnumber%> 
    </crm>

<!-- <%company%> + <%address%> are common values found in LETTERHEAD chunk, so they do not show up here (while they DO in the HTML template...) -->

<!--
     Invoice # 
     Invoice Date 
     Due Date 
     Order # 
     PO # 
     Salesperson 
     Shipping Point 
     Ship via 
-->
    <%invnumber%> 

    <%invdate%> 
    <%duedate%> 

    <!-- PO # -->
    <%ponumber%>

    <!-- Order # -->
    <%ordnumber%>

    <%employee%> 
    <%shippingpoint%> 
    <%shipvia%> 

<%if taxincluded%>
    <taxincluded value="true" />
<%end taxincluded%>

<!--
     Item 
     Number 
     Description 
     Qt'y 
     Unit Price 
     Disc % 
     Extended 
-->
<%foreach number%>
    <credit-item>
      <%runningnumber%>
      <%number%> 
      <%description%> 
      <%deliverydate%> 
      <%qty%> 
      <%unit%> 
      <%sellprice%> 
      <%discountrate%> 
      <%linetotal%> 
              
      <%notes%> 
    </credit-item>
<%end number%>

<%foreach tax%>
    <tax-registration-item>
      <!-- Registration No. -->
      <%taxnumber%>
      <%taxdescription%>
      <%taxbase%>
    
      <taxrate-percentage>
        <%taxrate%>
      </taxrate-percentage>
          
      <%tax%> 
    </tax-registration-item>
<%end tax%>

    <summary-totals>
<%if not taxincluded%>
      <sans-tax-subtotal>
        <%subtotal%>
      </sans-tax-subtotal>
<%end taxincluded%>

      <total>
        <%invtotal%>
      </total>

      <%text_amount%>
      
      <currency-decimal-value>
        <%decimal%>
      </currency-decimal-value>
    </summary-totals>

    <currency-info>
      <%currency%>
    </currency-info>

    <%notes%> 

<%foreach payment%>
    <refund-item>
      <%paymentdate%> 
      <%paymentaccount%> 
      <%paymentsource%> 
      <%paymentmemo%>
      <%payment%> 
    </refund-item>
<%end payment%>
  </content>

  <footer>    
<%if taxincluded%>
    <tax-included-msg>
      Taxes shown are included in price.
    </tax-included-msg>
<%end taxincluded%>
  </footer>
</sql-ledger-root>
